<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="stylesheet" type="text/css" href="/MaRSWebsite/assets/css/materialize.css"> <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"> <link rel="stylesheet" href="https://cdn.rawgit.com/konpa/devicon/df6431e323547add1b4cf45992913f15286456d3/devicon.min.css"> <title>MaRS (Malaria Drug Resistance Surveillence)</title> </head> <body> <div id="home" class="section scrollspy"> <div id="index-banner" class="parallax-container"> <div class="section no-pad-bot"> <div class="container"> <br><br> <h1 class="header center teal-text text-lighten-2">MaRS (Malaria Drug Resistance Surveillence)</h1> <div class="row center"> <h5 class="header col s12 light">The Malaria Resistance Surveillance or MaRS pipline, consists of a standardized laboratory and bioinformatics workflow for identifying variants in Plasmodium falciparum genomes conferring drug resistance. By streamlinging the data QC, alignment, and variant calling process, MaRS hopes to reduce time of analysis, as well allow for flexibilty of protocol used for the BGS analysis.</h5> </div> <br><br> </div> </div> <div class="parallax"><img src="assets/images/startup3.jpg" alt="Unsplashed background img 1"></div> </div> </div> <div id="cookies" style="display:none"> <p style="text-align:left; padding-left:8px"><a value="hide/show" id="check" class="waves-effect waves-light green lighten-1 btn btn-floating pulse" onclick="Materialize.toast('Thanks!', 2000)"><i class="material-icons">check</i></a></p> <div class="tap-target" data-activates="check"> <div class="tap-target-content"> <h5 style="color:black;">Cookie Policy</h5> <p>We use Cookies on this website to track usage. By contiuning to use this website, you agree to the use of Cookies.</p> <br><br><br> <p><b>For more information visit the <a href "https://www.cookielaw.org/google-analytics-eu-cookie-law/">Cookie Law Website.</a><b></p> </div> </div> </div> <div class="container" style="padding:20px;"> <div id="blog" class="section scrollspy"> <h3 style="text-align:center;">Blog</h3> <div class="row"> <div class="col s12 m6"> <div class="card"> <div class="card-image"> <img src="/assets/images/twoscreen.jpg"> <span class="card-title"><a style="color:white">Targeted Amplicon Deep Sequencing</a></span> <a id="/2018/02/27/MaRS-lab-sop/" class="btn-floating halfway-fab waves-effect waves-light red" href="/MaRSWebsite/2018/02/27/MaRS-lab-sop/"><i class="material-icons">more_horiz</i></a> </div> <div class="card-content"> <p><h1 id="targeted-amplicon-deep-sequencing-of-plasmodium-falciparum-pf-molecular-markers-of-resistance">Targeted Amplicon Deep Sequencing of <em>Plasmodium falciparum (Pf)</em> molecular markers of resistance</h1> </p> </div> </div> </div> <div class="col s12 m6"> <div class="card"> <div class="card-image"> <img src="/assets/images/twoscreen.jpg"> <span class="card-title"><a style="color:white">MaRS (Malaria Resistance Surveillance)</a></span> <a id="/2018/02/27/MaRS-bioinformatics-workflow/" class="btn-floating halfway-fab waves-effect waves-light red" href="/MaRSWebsite/2018/02/27/MaRS-bioinformatics-workflow/"><i class="material-icons">more_horiz</i></a> </div> <div class="card-content"> <p><h1 id="mars-malaria-resistance-surveillance">MaRS (Malaria Resistance Surveillance)</h1> <p>The emergence of resistance to all currently available antimalarial drugs in multiple regions of the world represents a current global public health challenge. In order to monitor and address this situation, faster and more effective surveillance tools are required to track and monitor the emergence and evolution of drug resistance in malaria. The Malaria Resistance Surveillance (MaRS) project aims to address this challenge by collating and mapping genetic polymorphisms associated with drug resistance in malaria around the world. The project achieves this by employing a targeted amplicon deep sequencing (TADS) approach <a href="https://github.com/CDCgov/MaRS/tree/master/lab_sop">Lab Protocol</a> to detect single nucleotide polymorphisms on all major malaria drug resistance genes associated genes in samples sourced from travelers returning to the US from overseas, as well as samples actively collected in collaboration with partners from other countries.</p> <p>Data for this project can be found at the following link <a href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA428490">NCBI BioProject</a>. Collaborators are encouraged to submit their own data using this <a href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA428490">NCBI BioProject</a></p> <p>The Malaria Resistance Surveillance or MaRS analysis pipline, is an attempt at standardizing the workflow for identifying both known and new polymorhisms in <em>P.falciparum</em> genes associated with drug resistance.</p> <h2 id="version-histroy">Version Histroy</h2> <ul> <li>Version 1.1.1 (1/9/2018) <ul> <li>Fastq samples detected from directory</li> <li>Reference and dependencies for analysis on P.falciparum provided with the git bundle</li> <li>BBDuk used to trim reads</li> <li>BWA used for read alignment</li> <li>Variant calling using Samtools and GATK</li> <li>Summary tables for samples with separate tables for known and novel variants</li> <li>Summary heatmaps and frequency graphs generated</li> <li>The framework has been tested to work on Ubuntu 16.04 and RedHat Enterprise Linux Server Edition 6.8</li> </ul> </li> </ul> <h1 id="setup">Setup</h1> <h2 id="getting-started">Getting started</h2> <ol> <li>Download git repository:</li> </ol> <p>Clone the master branch of this repository.</p> <pre><code class="language-{sh}">git clone https://github.com/CDCgov/MaRS.git
</code></pre> <ol> <li>Download dependencies:</li> </ol> <p>Download dependencies listed below. All the tools that are required to run MaRS included in the lib directory of the repository. However, make sure that the Python and Java versions and packages are installed on the system.</p> <ol> <li>Your first analysis:</li> </ol> <p>Follow the directory structure listed below and use the run script included with the bundle to run your first analysis.</p> <pre><code class="language-{sh}">sh run.sh &lt;path to experiment folder&gt; &lt;path to output folder&gt;
</code></pre> <p>For example if you have stored your fastq files in <code class="highlighter-rouge">fq/</code> folder and you want to store the results in the folder <code class="highlighter-rouge">local/</code>. You can run the following command from the MaRS directory.</p> <pre><code class="language-{sh}">sh run.sh fq/ local/
</code></pre> <h2 id="depdencies">Depdencies:</h2> <ol> <li><a href="https://www.python.org/download/releases/3.4.0/">Python3.4 </a></li> <li><a href="http://download.oracle.com/otn-pub/java/jdk/9.0.1+11/jre-9.0.1_linux-x64_bin.tar.gz">Java (Version : 9.0.1)</a></li> <li><a href="http://pandas.pydata.org/pandas-docs/stable/">Pandas (Version : 0.22.0)</a></li> <li><a href="https://www.scipy.org/install.html">Numpy (Version : 1.13.3)</a></li> <li><a href="https://seaborn.pydata.org/">Seaborn (Version : 0.8.1)</a></li> <li><a href="https://pypi.python.org/pypi/openpyxl">Openpyxl (Version : 2.4.9)</a></li> <li><a href="https://sourceforge.net/projects/bbmap/">BBMap (Version : v35.x)</a></li> <li><a href="http://bio-bwa.sourceforge.net/">BWA (Version : 0.7.12)</a></li> <li><a href="http://bowtie-bio.sourceforge.net/bowtie2/index.shtml">Bowtie2 (Version : 2.3.3.1)</a></li> <li><a href="http://snap.cs.berkeley.edu/">Snap (Version : 1.0beta23)</a></li> <li><a href="http://www.htslib.org/">Samtools (Version : 1.3.1)</a></li> <li><a href="http://www.htslib.org/">Bctools (Version : 1.3.1)</a></li> <li><a href="https://software.broadinstitute.org/gatk/download/">GATK (Version : 3.6-0-g89b7209)</a></li> </ol> <h2 id="directory-structure">Directory structure:</h2> <ol> <li>fq</li> </ol> <ul> <li>Contains all the input fastq files</li> </ul> <ol> <li>lib</li> </ol> <ul> <li>Contains the binaries for all the tools that MaRS can run</li> </ul> <ol> <li>local</li> </ol> <ul> <li>Local output folder</li> </ul> <ol> <li>pyamd</li> </ol> <ul> <li>Contains all the MaRS classes.</li> </ul> <ol> <li>ref</li> </ol> <ul> <li>Contains reference sequences. For the current version, the ref folder must also contain the alignment indicies.</li> </ul> <h2 id="creating-alignment-indicies">Creating alignment indicies:</h2> <ol> <li>BWA: <pre><code class="language-{sh}">bwa index &lt;reference-fasta.fa&gt;
</code></pre> </li> </ol> <h2 id="output-directory-structure">Output directory structure:</h2> <ul> <li> <p>For each sample</p> <ol> <li>CleanedFastq: Folder containing adapter trimmed and quality filtered fastq files</li> <li>output.sam : Contains reads aligned to reference genome</li> <li>output_sorted.bam : Sorted BAM containing aligned reads</li> <li>output_sorted_RG.bam : Read gtroup added BAM file</li> <li>outout_fixmate.bam : Final BAM file, with mate information corrected</li> <li>variants.vcf : Variant calls from samtools</li> <li>variants_gatk.vcf : Variant calls from GATK HaplotypeCaller</li> <li>variants_samtools.bed : Annotated variant calls from samtools, in tab delimited format</li> <li>variants_gatk.bed : Annotated variant calls from GATK, in tab delimited format</li> </ol> </li> <li> <p>For the study</p> <ol> <li>Study_variants.xlsx : Summary table of all known variants that confer drug resistance, for all samples in the study</li> <li>Study_depth.xlsx : Summary of depth of coverage for codon correponding to variants that confer drug resistance</li> <li>Study_al_freq.xlsx : Summary of allele frequency of variants that confer drug resistance</li> <li>Study_novel_exonic_variants.xlsx : Summary of all novel variants found in exonic regions, for all samples in the study</li> <li>Study_novel_intronic_variants.xlsx : Summary of all novel variants found in intronic regions, for all samples in the study</li> <li>Study_novel_var_af.xlsx : Summary of allele frequency of novel variants for all samples</li> <li>Study_novel_var_depth.xlsx : Summary of depth of coverage for codon correponding to novel variants for all samples</li> <li>voi_af_heatmap.jpg : Heatmap showing the allele frequency across all samples for variants known to confer drug resistance</li> <li>voi_dp_heatmap.jpg : Heatmap showing the codon coverage across all samples for variants known to confer drug resistance</li> <li>voi_frequency.jpg : Count plot showing frequency variants conferring drug resistance across all the samples in the study</li> </ol> </li> </ul> </p> </div> </div> </div> </div> </div> </div> <div class="container" style="padding:20px;"> <div id="portfolio" class="section scrollspy"> <h3 style="text-align:center;">Projects</h3> <div class="row"> <div class="col s12 m6"> <div class="card medium sticky-action"> <div class="card-image waves-effect waves-block waves-light"> <img class="activator" src="/MaRSWebsite/assets/images/desk.jpg"> </div> <div class="card-action"> <span class="card-title activator grey-text text-darken-4">MaRS Lab Protocol<i class="material-icons right">more_vert</i></span> <p><a href="https://github.com/CDCgov/MaRS/blob/master/lab_sop/MaRSsop.md">Github</a></p> </div> <div class="card-reveal"> <span class="card-title grey-text text-darken-4"><i class="material-icons right">close</i></span> <p>Preparing full length genes Pf kelch 13 (k13), Pf chloroquine resistant transporter (crt), Pf multidrug resistant protein 1 (mdr1), Pf bifunctional dihydrofolate reductase-thymidylate synthase (dhfr), Pf dihydropteroate synthase (dhps) and mitochondrial genome amplicons for sequencing on the Illumina MiSeq system</p> </div> </div> </div> <div class="col s12 m6"> <div class="card medium sticky-action"> <div class="card-image waves-effect waves-block waves-light"> <img class="activator" src="/MaRSWebsite/assets/images/typewriter.jpg"> </div> <div class="card-action"> <span class="card-title activator grey-text text-darken-4">MaRS Bioinformatics Pipeline<i class="material-icons right">more_vert</i></span> <p><a href="https://github.com/CDCgov/MaRS">Github</a></p> </div> <div class="card-reveal"> <span class="card-title grey-text text-darken-4"><i class="material-icons right">close</i></span> <p>The Malaria Resistance Surveillance or MaRS analysis pipline, is an attempt at standardizing the workflow for identifying both known and new polymorhisms in P.falciparum genes associated with drug resistance.</p> </div> </div> </div> </div> </div> </div> <div class="container" style="padding:20px;"> <div id="skills" class="section scrollspy"> <h3 style="text-align:center;">Tools and Experience</h3> <div class="row"> <div class="col s12"> <div class="card"> <div class="card-image"> <span class="card-title"><a style="color:white" href=""></a></span> </div> <div class="card-content"> <i class="devicon-amazonwebservices-plain colored" style="font-size:50px;"></i> <i class="devicon-android-plain colored" style="font-size:50px;"></i> <i class="devicon-angularjs-plain colored" style="font-size:50px;"></i> <i class="devicon-apache-plain colored" style="font-size:50px;"></i> <i class="devicon-appcelerator-plain colored" style="font-size:50px;"></i> <i class="devicon-apple-plain colored" style="font-size:50px;"></i> <i class="devicon-atom-plain colored" style="font-size:50px;"></i> <i class="devicon-babel-plain colored" style="font-size:50px;"></i> <i class="devicon-backbonejs-plain colored" style="font-size:50px;"></i> <i class="devicon-bitbucket-plain colored" style="font-size:50px;"></i> <i class="devicon-bootstrap-plain colored" style="font-size:50px;"></i> <i class="devicon-bower-plain colored" style="font-size:50px;"></i> <i class="devicon-c-plain colored" style="font-size:50px;"></i> <i class="devicon-chrome-plain colored" style="font-size:50px;"></i> <i class="devicon-codeigniter-plain colored" style="font-size:50px;"></i> <i class="devicon-coffescript-plain colored" style="font-size:50px;"></i> <i class="devicon-confluence-plain colored" style="font-size:50px;"></i> <i class="devicon-cplusplus-plain colored" style="font-size:50px;"></i> <i class="devicon-csharp-plain colored" style="font-size:50px;"></i> <i class="devicon-css3-plain colored" style="font-size:50px;"></i> <i class="devicon-cucumber-plain colored" style="font-size:50px;"></i> <i class="devicon-d3js-plain colored" style="font-size:50px;"></i> <i class="devicon-debian-plain colored" style="font-size:50px;"></i> <i class="devicon-devicon-plain colored" style="font-size:50px;"></i> <i class="devicon-django-plain colored" style="font-size:50px;"></i> <i class="devicon-docker-plain colored" style="font-size:50px;"></i> <i class="devicon-doctrine-plain colored" style="font-size:50px;"></i> <i class="devicon-dot-net-plain colored" style="font-size:50px;"></i> <i class="devicon-drupal-plain colored" style="font-size:50px;"></i> <i class="devicon-erlang-plain colored" style="font-size:50px;"></i> <i class="devicon-facebook-plain colored" style="font-size:50px;"></i> <i class="devicon-firefox-plain colored" style="font-size:50px;"></i> <i class="devicon-foundation-plain colored" style="font-size:50px;"></i> <i class="devicon-gatling-plain colored" style="font-size:50px;"></i> <i class="devicon-gimp-plain colored" style="font-size:50px;"></i> <i class="devicon-git-plain colored" style="font-size:50px;"></i> <i class="devicon-github-plain colored" style="font-size:50px;"></i> <i class="devicon-gitlab-plain colored" style="font-size:50px;"></i> <i class="devicon-go-plain colored" style="font-size:50px;"></i> <i class="devicon-google-plain colored" style="font-size:50px;"></i> <i class="devicon-gradle-plain colored" style="font-size:50px;"></i> <i class="devicon-grunt-plain colored" style="font-size:50px;"></i> <i class="devicon-gulp-plain colored" style="font-size:50px;"></i> <i class="devicon-heroku-plain colored" style="font-size:50px;"></i> <i class="devicon-html5-plain colored" style="font-size:50px;"></i> <i class="devicon-ie10-plain colored" style="font-size:50px;"></i> <i class="devicon-illustrator-plain colored" style="font-size:50px;"></i> <i class="devicon-inkscape-plain colored" style="font-size:50px;"></i> <i class="devicon-itellij-plain colored" style="font-size:50px;"></i> <i class="devicon-java-plain colored" style="font-size:50px;"></i> <i class="devicon-jasmine-plain colored" style="font-size:50px;"></i> <i class="devicon-javascript-plain colored" style="font-size:50px;"></i> <i class="devicon-laravel-plain colored" style="font-size:50px;"></i> <i class="devicon-less-plain colored" style="font-size:50px;"></i> <i class="devicon-linux-plain colored" style="font-size:50px;"></i> <i class="devicon-meteor-plain colored" style="font-size:50px;"></i> <i class="devicon-mocha-plain colored" style="font-size:50px;"></i> <i class="devicon-mongodb-plain colored" style="font-size:50px;"></i> <i class="devicon-moodle-plain colored" style="font-size:50px;"></i> <i class="devicon-mysql-plain colored" style="font-size:50px;"></i> <i class="devicon-nginx-plain colored" style="font-size:50px;"></i> <i class="devicon-nodejs-plain colored" style="font-size:50px;"></i> <i class="devicon-nodewebkit-plain colored" style="font-size:50px;"></i> <i class="devicon-oracle-plain colored" style="font-size:50px;"></i> <i class="devicon-photoshop-plain colored" style="font-size:50px;"></i> <i class="devicon-php-plain colored" style="font-size:50px;"></i> <i class="devicon-phpstorm-plain colored" style="font-size:50px;"></i> <i class="devicon-protractor-plain colored" style="font-size:50px;"></i> <i class="devicon-postgresql-plain colored" style="font-size:50px;"></i> <i class="devicon-python-plain colored" style="font-size:50px;"></i> <i class="devicon-pycharm-plain colored" style="font-size:50px;"></i> <i class="devicon-rails-plain colored" style="font-size:50px;"></i> <i class="devicon-react-plain colored" style="font-size:50px;"></i> <i class="devicon-redhat-plain colored" style="font-size:50px;"></i> <i class="devicon-redis-plain colored" style="font-size:50px;"></i> <i class="devicon-ruby-plain colored" style="font-size:50px;"></i> <i class="devicon-rubymine-plain colored" style="font-size:50px;"></i> <i class="devicon-safari-plain colored" style="font-size:50px;"></i> <i class="devicon-sass-plain colored" style="font-size:50px;"></i> <i class="devicon-sequelize-plain colored" style="font-size:50px;"></i> <i class="devicon-slack-plain colored" style="font-size:50px;"></i> <i class="devicon-sourcetree-plain colored" style="font-size:50px;"></i> <i class="devicon-ssh-plain colored" style="font-size:50px;"></i> <i class="devicon-swift-plain colored" style="font-size:50px;"></i> <i class="devicon-symfony-plain colored" style="font-size:50px;"></i> <i class="devicon-tomcat-plain colored" style="font-size:50px;"></i> <i class="devicon-travis-plain colored" style="font-size:50px;"></i> <i class="devicon-trello-plain colored" style="font-size:50px;"></i> <i class="devicon-twitter-plain colored" style="font-size:50px;"></i> <i class="devicon-typescript-plain colored" style="font-size:50px;"></i> <i class="devicon-ubuntu-plain colored" style="font-size:50px;"></i> <i class="devicon-vim-plain colored" style="font-size:50px;"></i> <i class="devicon-visualstudio-plain colored" style="font-size:50px;"></i> <i class="devicon-vuejs-plain colored" style="font-size:50px;"></i> <i class="devicon-webpack-plain colored" style="font-size:50px;"></i> <i class="devicon-webstorm-plain colored" style="font-size:50px;"></i> <i class="devicon-windows8-plain colored" style="font-size:50px;"></i> <i class="devicon-wordpress-plain colored" style="font-size:50px;"></i> <i class="devicon-yii-plain colored" style="font-size:50px;"></i> <i class="devicon-zend-plain colored" style="font-size:50px;"></i> </div> </div> </div> </div> </div> </div> <div class="parallax-container valign-wrapper"> <div class="section no-pad-bot"> <div class="container"> <div class="row center"> </div> </div> </div> <div class="parallax"><img src="assets/images/startup3.jpg" alt="Unsplashed background img 3"></div> </div> <div class="container" style="padding:20px;"> <div id="contact" class="section scrollspy"> <h3 style="text-align:center;">Contact</h3> <div class="card medium"> <div class="card-image waves-effect waves-block waves-light"> <img class="activator" src="/MaRSWebsite/assets/images/contact4.png"> </div> <div class="card-content"> <span class="card-title activator" style="text-align:right;"><a class="btn-floating waves-effect waves-light red pulse"><i class="large material-icons">arrow_drop_up</i></a></span> <div class="row" style="text-align:center"> <a class="waves-effect waves-light btn grey darken-1" target="_blank" href="https://github.com/jameshamann/jekyll-material-theme"><i class="material-icons right">code</i>Github</a> <a class="waves-effect waves-light btn green darken-2" target="_blank" href="https://medium.com"><i class="material-icons right">library_books</i>Medium</a> </div> </div> <div class="card-reveal"> <span class="card-title grey-text text-darken-4">Contact Form<i size="large" class="material-icons right">close</i></span> <form class="col s12" action="https://formspree.io/your-email@example.com" method="POST"> <div class="row"> <div class="input-field col s6"> <i class="material-icons prefix">account_circle</i> <input class="validate" id="icon_prefix" type="text" name="name"> <label for="icon_prefix">Name</label> </div> <div class="input-field col s6"> <i class="material-icons prefix">email</i> <input class="validate" id="email" type="email" name="_replyto"> <label for="email" data-error="Please enter a valid Email Address" data-success="Verified!">Email</label> </div> </div> <div class="row"> <div class="input-field col s12"> <i class="material-icons prefix">message</i> <textarea id="icon_prefix2" class="materialize-textarea" name="message"></textarea> <label for="icon_prefix2">Message</label> </div> </div> <button class="btn waves-effect grey waves-dark darken-3 white-text z-depth-4" type="submit" name="action">Submit <i class="material-icons right">send</i> </button> </form> </div> </div> </div> </div> <div class="fixed-action-btn horizontal click-to-toggle"> <a class="btn-floating btn-large waves-effect waves-default pulse"> <i class="material-icons">menu</i> </a> <ul> <li><a class="btn-floating blue darken-2 waves-effect waves-default" href="#home"><i class="material-icons">arrow_upward</i></a></li> <li><a class="btn-floating green darken-2 waves-effect waves-default" href="#portfolio"><i class="material-icons">code</i></a></li> <li><a class="btn-floating yellow darken-3 waves-effect waves-default" href="#blog"><i class="material-icons">library_books</i></a></li> <li><a class="btn-floating red darken-1 waves-effect waves-default" href="#contact"><i class="material-icons">person</i></a></li> </ul> </div> <script type="text/javascript" src="/MaRSWebsite/assets/js/jquery-3.2.1.min.js"></script> <script type="text/javascript" src="/MaRSWebsite/assets/js/materialize.min.js"></script> <script src="/MaRSWebsite/assets/js/init.js"></script> </body> <footer class="page-footer"> <div class="footer-copyright" style="padding-left: 30px"> <i class="material-icons" style="padding-right:5px">copyright</i><p>2018 Copyright Malaria Branch, CDC | All rights reserved</p> </div> </footer> </html>